<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>File / Link Malware Scan – Raina</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .transition-theme {
      transition: background-color 0.4s ease, color 0.4s ease;
    }
  </style>
</head>
<body id="body" class="bg-gray-900 text-white flex flex-col items-center min-h-screen p-6 gap-6 font-mono transition-theme">
  <a href="index.html" class="self-start text-gray-400 hover:text-white">← Back</a>
  <h2 class="text-3xl font-bold">🗂️ File / Link Malware Scan</h2>

  
  <p class="text-gray-400 max-w-2xl text-center">
    File and link scanning is a crucial step in cybersecurity. 
    Malicious files and phishing links are often disguised as harmless downloads or shared documents. 
    Hackers use them to deliver malware, steal personal information, or compromise systems. 
    Scanning ensures you detect threats early and stay protected before opening or sharing files.
  </p>

  <div id="infoBox" class="bg-gray-800 text-sm p-4 rounded-xl max-w-2xl text-gray-300 transition-theme">
    <p>📂 Enter a <strong>direct download link</strong> of a file to check if it's flagged by antivirus engines via VirusTotal backend.</p>
    <p class="mt-2">🧪 Try with sample link: <code>http://example.com/file.exe</code></p>
  </div>

  <div class="w-full max-w-xl flex flex-col gap-4">
    <input id="linkInput" type="url" placeholder="Paste file download URL" class="p-3 rounded-xl text-black" />
    <button onclick="scanLink()" id="scanBtn" class="bg-gray-700 hover:bg-gray-800 py-3 rounded-xl shadow-lg font-semibold transition-theme">
      Scan
    </button>
    <div id="linkResult" class="text-lg font-bold min-h-[2rem]"></div>
  </div>

  <div id="detailsBox" class="hidden w-full max-w-2xl mt-4 bg-gray-800 text-white p-4 rounded-xl shadow-lg space-y-2 transition-theme"></div>

  <script>
    const BACKEND_URL = 'https://ai-cyber-backend-1.onrender.com/scan';

    function setThemeSafe() {
      document.getElementById('body').className = 'bg-green-950 text-white flex flex-col items-center min-h-screen p-6 gap-6 font-mono transition-theme';
      document.getElementById('scanBtn').className = 'bg-green-600 hover:bg-green-700 py-3 rounded-xl shadow-lg font-semibold transition-theme';
      document.getElementById('infoBox').className = 'bg-green-900 text-sm p-4 rounded-xl max-w-2xl text-green-200 transition-theme';
      document.getElementById('detailsBox').className = 'w-full max-w-2xl mt-4 bg-green-900 text-white p-4 rounded-xl shadow-lg space-y-2 transition-theme';
    }

    function setThemeUnsafe() {
      document.getElementById('body').className = 'bg-red-950 text-white flex flex-col items-center min-h-screen p-6 gap-6 font-mono transition-theme';
      document.getElementById('scanBtn').className = 'bg-red-600 hover:bg-red-700 py-3 rounded-xl shadow-lg font-semibold transition-theme';
      document.getElementById('infoBox').className = 'bg-red-900 text-sm p-4 rounded-xl max-w-2xl text-red-200 transition-theme';
      document.getElementById('detailsBox').className = 'w-full max-w-2xl mt-4 bg-red-900 text-white p-4 rounded-xl shadow-lg space-y-2 transition-theme';
    }

    function resetTheme() {
      document.getElementById('body').className = 'bg-gray-900 text-white flex flex-col items-center min-h-screen p-6 gap-6 font-mono transition-theme';
      document.getElementById('scanBtn').className = 'bg-gray-700 hover:bg-gray-800 py-3 rounded-xl shadow-lg font-semibold transition-theme';
      document.getElementById('infoBox').className = 'bg-gray-800 text-sm p-4 rounded-xl max-w-2xl text-gray-300 transition-theme';
      document.getElementById('detailsBox').className = 'w-full max-w-2xl mt-4 bg-gray-800 text-white p-4 rounded-xl shadow-lg space-y-2 transition-theme';
    }

    async function scanLink() {
      const url = document.getElementById('linkInput').value.trim();
      const resEl = document.getElementById('linkResult');
      const detailsEl = document.getElementById('detailsBox');

      detailsEl.classList.add('hidden');
      detailsEl.innerHTML = '';
      resEl.textContent = '';
      resetTheme();

      if (!url) {
        resEl.textContent = '⚠️ Please enter a URL.';
        resEl.className = 'text-yellow-400 font-bold';
        return;
      }

      resEl.textContent = '⏳ Scanning via Raina backend...';
      resEl.className = 'text-white font-bold';

      try {
        const response = await fetch(BACKEND_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ url })
        });

        if (!response.ok) throw new Error('Server error');

        const data = await response.json();
        const stats = data.data.attributes.stats;
        const total = stats.malicious + stats.suspicious;

        if (total > 0) {
          resEl.textContent = `⚠️ Detected as malicious by ${total} engine(s)!`;
          resEl.className = 'text-red-400 font-bold';
          setThemeUnsafe();

          detailsEl.innerHTML = `
            <p><strong>🧪 Engines flagged:</strong> ${total}</p>
            <p><strong>🛑 Malicious:</strong> ${stats.malicious}</p>
            <p><strong>⚠️ Suspicious:</strong> ${stats.suspicious}</p>
            <p><strong>🔗 URL scanned:</strong> ${url}</p>
          `;
        } else {
          resEl.textContent = '✅ No engines flagged this URL.';
          resEl.className = 'text-green-400 font-bold';
          setThemeSafe();

          detailsEl.innerHTML = `
            <p><strong>✅ This file appears clean:</strong> ${url}</p>
            <p>Scanned across multiple engines. No malware or suspicious activity detected.</p>
          `;
        }

        detailsEl.classList.remove('hidden');
      } catch (err) {
        console.error('Scan failed:', err);
        resEl.textContent = '❌ Error scanning the URL.';
        resEl.className = 'text-red-400 font-bold';
      }
    }
  </script>
</body>
</html>
