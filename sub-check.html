<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Subdomain Finder – Raina</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .transition-theme {
      transition: background-color 0.4s ease, color 0.4s ease;
    }
    .scroll-box {
      max-height: 400px;
      overflow-y: auto;
      background-color: black;
      color: #00ff88;
      font-size: 14px;
      padding: 10px;
      border-radius: 8px;
      white-space: pre-wrap;
    }
  </style>
</head>
<body id="body" class="bg-gray-900 text-white flex flex-col items-center min-h-screen p-6 gap-6 font-mono transition-theme">
  <a href="index.html" class="self-start text-gray-400 hover:text-white">← Back</a>
  <h2 class="text-3xl font-bold">🌐 Subdomain Finder</h2>
  <p class="text-gray-400 max-w-2xl text-center">
    Subdomain finding helps security researchers discover hidden applications, admin panels, or forgotten services 
    running under a target domain. Hackers often use it for reconnaissance before launching attacks, 
    making it one of the first and most important steps in ethical hacking.
  </p>

  <div id="infoBox" class="bg-gray-800 text-sm p-4 rounded-xl max-w-2xl text-gray-300 transition-theme">
    <p>🔎 Enter a domain to find subdomains using <code>crt.sh</code>.</p>
    <p class="mt-2">🧪 Example: <code>spotify.com</code> (do not include http:// or https://)</p>
    <p class="mt-2 text-yellow-400">⚠️ Fetching domains may take some time because free backend servers are slow.</p>
  </div>

  <div class="w-full max-w-xl flex flex-col gap-4">
    <input id="domainInput" type="text" placeholder="Enter domain (e.g., spotify.com)" class="p-3 rounded-xl text-black" />
    <button onclick="findSubdomains()" id="scanBtn" class="bg-gray-700 hover:bg-gray-800 py-3 rounded-xl shadow-lg font-semibold transition-theme">
      Find Subdomains
    </button>
    <div id="result" class="text-lg font-bold min-h-[2rem]"></div>
  </div>

  <div id="detailsBox" class="hidden w-full max-w-3xl mt-4 bg-gray-800 text-white p-4 rounded-xl shadow-lg space-y-2 transition-theme">
    <div class="flex justify-between items-center">
      <h3 class="text-xl font-bold">📜 Subdomains</h3>
      <button onclick="toggleRaw()" class="bg-black hover:bg-gray-700 px-3 py-1 rounded-md text-xs shadow">
        📂 See Raw
      </button>
    </div>
    <div id="subdomainList" class="scroll-box"></div>
  </div>

  <div id="rawBox" class="hidden w-full max-w-3xl mt-4 bg-black text-green-200 p-4 rounded-xl shadow-lg transition-theme overflow-auto text-xs whitespace-pre"></div>

  <script>
    let loadingInterval;

    function setThemeSafe() {
      document.getElementById('body').className =
        'bg-green-950 text-white flex flex-col items-center min-h-screen p-6 gap-6 font-mono transition-theme';
      document.getElementById('scanBtn').className =
        'bg-green-600 hover:bg-green-700 py-3 rounded-xl shadow-lg font-semibold transition-theme';
      document.getElementById('infoBox').className =
        'bg-green-900 text-sm p-4 rounded-xl max-w-2xl text-green-200 transition-theme';
      document.getElementById('detailsBox').className =
        'w-full max-w-3xl mt-4 bg-green-900 text-white p-4 rounded-xl shadow-lg space-y-2 transition-theme';
    }
  
    function setThemeUnsafe() {
      document.getElementById('body').className =
        'bg-red-950 text-white flex flex-col items-center min-h-screen p-6 gap-6 font-mono transition-theme';
      document.getElementById('scanBtn').className =
        'bg-red-600 hover:bg-red-700 py-3 rounded-xl shadow-lg font-semibold transition-theme';
      document.getElementById('infoBox').className =
        'bg-red-900 text-sm p-4 rounded-xl max-w-2xl text-red-200 transition-theme';
      document.getElementById('detailsBox').className =
        'w-full max-w-3xl mt-4 bg-red-900 text-white p-4 rounded-xl shadow-lg space-y-2 transition-theme';
    }
  
    function resetTheme() {
      document.getElementById('body').className =
        'bg-gray-900 text-white flex flex-col items-center min-h-screen p-6 gap-6 font-mono transition-theme';
      document.getElementById('scanBtn').className =
        'bg-gray-700 hover:bg-gray-800 py-3 rounded-xl shadow-lg font-semibold transition-theme';
      document.getElementById('infoBox').className =
        'bg-gray-800 text-sm p-4 rounded-xl max-w-2xl text-gray-300 transition-theme';
      document.getElementById('detailsBox').className =
        'w-full max-w-3xl mt-4 bg-gray-800 text-white p-4 rounded-xl shadow-lg space-y-2 transition-theme';
    }

    function startLoadingAnimation(resEl) {
      let dots = 0;
      clearInterval(loadingInterval);
      loadingInterval = setInterval(() => {
        dots = (dots + 1) % 6;
        let dotStr = '.'.repeat(dots <= 3 ? dots : 6 - dots);
        resEl.textContent = '⏳ Fetching subdomains' + dotStr;
      }, 500);
    }

    function stopLoadingAnimation() {
      clearInterval(loadingInterval);
    }
  
    async function findSubdomains() {
      const input = document.getElementById('domainInput').value.trim();
      const domain = input.replace(/^https?:\/\//, '');
      const resEl = document.getElementById('result');
      const detailsEl = document.getElementById('detailsBox');
      const rawEl = document.getElementById('rawBox');
      const subdomainListEl = document.getElementById('subdomainList');
  
      detailsEl.classList.add('hidden');
      rawEl.classList.add('hidden');
      subdomainListEl.innerHTML = '';
      rawEl.innerHTML = '';
      resEl.textContent = '';
      resetTheme();
  
      if (!domain) {
        resEl.textContent = '⚠️ Please enter a domain.';
        resEl.className = 'text-yellow-400 font-bold';
        return;
      }
  
      resEl.className = 'text-white font-bold';
      startLoadingAnimation(resEl);
  
      try {
        const response = await fetch(`https://crt.sh/?q=${domain}&output=json`);
        if (!response.ok) throw new Error('Server error');
  
        const text = await response.text();
  
        let data;
        try {
          data = JSON.parse(text);
        } catch (e) {
          stopLoadingAnimation();
          console.error('Parsing error:', e, text.slice(0, 200));
          resEl.textContent = '❌ Failed to parse response (invalid JSON).';
          resEl.className = 'text-red-400 font-bold';
          setThemeUnsafe();
          return;
        }
  
        stopLoadingAnimation();
  
        if (!Array.isArray(data) || data.length === 0) {
          resEl.textContent = '❌ No subdomains found.';
          resEl.className = 'text-red-400 font-bold';
          setThemeUnsafe();
          return;
        }
  
        resEl.textContent = `✅ Found ${data.length} results (showing unique subdomains)`;
        resEl.className = 'text-green-400 font-bold';
        setThemeSafe();
  
        
        const allNames = data.flatMap(item => item.name_value.split(/\n+/));
        const subdomains = [...new Set(allNames)].sort();
        subdomainListEl.textContent = subdomains.join("\n");
  
        detailsEl.classList.remove('hidden');
        rawEl.textContent = JSON.stringify(data, null, 2);
  
      } catch (err) {
        stopLoadingAnimation();
        console.error('Error:', err);
        resEl.textContent = '❌ Error fetching subdomains.';
        resEl.className = 'text-red-400 font-bold';
        setThemeUnsafe();
      }
    }
  
    function toggleRaw() {
      const rawEl = document.getElementById('rawBox');
      rawEl.classList.toggle('hidden');
    }
  </script>
</body>
</html>
